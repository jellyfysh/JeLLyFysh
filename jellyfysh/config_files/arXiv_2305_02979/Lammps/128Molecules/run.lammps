variable      temp equal 299.7 # K
variable      dt equal 1 # fs
variable      rc equal 9.8 # A
variable      nsteps equal   8000000

units         real
atom_style    full

pair_style lj/cut/coul/long ${rc} ${rc}
kspace_style  pppm 1e-6
bond_style    harmonic
angle_style harmonic

read_data water_q-SPC-FW.lmp

velocity      all create ${temp} 76125 

variable      tdamp equal 300*${dt}

fix           NVT all   nvt temp ${temp} ${temp} ${tdamp}

#these  lines for the dipole moment
compute cc1 all chunk/atom molecule
compute myChunk all dipole/chunk cc1
variable xP equal ave(c_myChunk[1])
variable yP equal ave(c_myChunk[2])
variable zP equal ave(c_myChunk[3])
#fix 1 all ave/time 100 1 100 c_myChunk[*] file dipole.out  mode vector
fix 1 all ave/time 64 1 64 v_xP v_yP v_zP file dipole.out

thermo        1000
thermo_style  custom step temp press  density pe  # v_xP v_yP v_zP

neigh_modify delay 0 every 1 check yes

timestep      ${dt}
run           ${nsteps}


#final configuration
write_restart waterMolecules.restart.1
